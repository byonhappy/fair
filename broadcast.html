<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>2025 ë¶€ì—¬ Onì„¸ì§„ í–‰ë³µêµìœ¡ ë°•ëŒíšŒ - ì‹œì¢… ë°©ì†¡</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    /* style.cssì— ì¶”ê°€ëœ broadcast-body, broadcast-time ë“±ì˜ ìŠ¤íƒ€ì¼ì´ ì—¬ê¸°ì„œ ì ìš©ë©ë‹ˆë‹¤. */
    #startBtn {
        /* ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì¶”ê°€ */
        background: #18c2a6;
        color: #fff;
        border: none;
        padding: 15px 30px;
        font-size: 1.5em;
        font-weight: bold;
        border-radius: 10px;
        cursor: pointer;
        margin-bottom: 30px;
        transition: background 0.2s;
    }
    #startBtn:hover {
        background: #14b4c7;
    }
    /* ë²„íŠ¼ í´ë¦­ ì „/í›„ ìƒíƒœë¥¼ ìœ„í•œ ìŠ¤íƒ€ì¼ */
    .initial-state #statusText,
    .initial-state #scheduleList,
    .initial-state #currentTime {
        display: none;
    }
    .active-state #startBtn {
        display: none;
    }
  </style>
</head>
<body class="broadcast-body initial-state">

  <h1 class="broadcast-title">ğŸ”” ì‹œì¢… ë°©ì†¡ ì œì–´íŒ</h1>
  
  <button id="startBtn">ë°©ì†¡ ì‹œì‘ (í´ë¦­ í›„ ì‘ë™)</button>

  <div id="currentTime" class="broadcast-time">--:--:--</div>
  <p id="statusText" class="status-text">ì‹œìŠ¤í…œ ì¤€ë¹„ ì¤‘...</p>
  
  <ul id="scheduleList" class="schedule-list">
    </ul>

  <audio id="startBell" src="start.mp3" preload="auto"></audio>
  <audio id="endBell" src="end.mp3" preload="auto"></audio>

  <script>
    const SCHEDULE = [
      { time: '09:25', type: 'start', label: '1êµì‹œ ì‹œì‘' },
      { time: '09:55', type: 'end', label: '1êµì‹œ ì¢…ë£Œ' },
      { time: '10:10', type: 'start', label: '2êµì‹œ ì‹œì‘' },
      { time: '10:40', type: 'end', label: '2êµì‹œ ì¢…ë£Œ' },
      { time: '10:55', type: 'start', label: '3êµì‹œ ì‹œì‘' },
      { time: '11:25', type: 'end', label: '3êµì‹œ ì¢…ë£Œ' },
      { time: '11:40', type: 'start', label: '4êµì‹œ ì‹œì‘' },
      { time: '12:10', type: 'end', label: '4êµì‹œ ì¢…ë£Œ / ì ì‹¬ì‹œê°„ ì‹œì‘' },
      { time: '13:20', type: 'start', label: '5êµì‹œ ì‹œì‘ / ì ì‹¬ì‹œê°„ ì¢…ë£Œ' },
      { time: '13:50', type: 'end', label: '5êµì‹œ ì¢…ë£Œ' },
      { time: '14:05', type: 'start', label: '6êµì‹œ ì‹œì‘' },
      { time: '14:35', type: 'end', label: '6êµì‹œ ì¢…ë£Œ' },
      { time: '14:50', type: 'start', label: '7êµì‹œ ì‹œì‘' },
      { time: '15:20', type: 'end', label: '7êµì‹œ ì¢…ë£Œ' },
      { time: '15:35', type: 'start', label: '8êµì‹œ ì‹œì‘' },
      { time: '16:05', type: 'end', label: '8êµì‹œ ì¢…ë£Œ / í–‰ì‚¬ ë§ˆê°' },
    ];

    const bodyEl = document.querySelector('.broadcast-body');
    const startBtn = document.getElementById('startBtn');
    const currentTimeEl = document.getElementById('currentTime');
    const statusTextEl = document.getElementById('statusText');
    const scheduleListEl = document.getElementById('scheduleList');
    const startBell = document.getElementById('startBell');
    const endBell = document.getElementById('endBell');
    
    // ì¬ìƒ ì¤‘ë³µ ë°©ì§€ë¥¼ ìœ„í•œ í”Œë˜ê·¸
    let lastPlayedTime = null;
    let clockInterval = null; // ì¸í„°ë²Œ ID ì €ì¥

    // ìŠ¤ì¼€ì¤„ ëª©ë¡ì„ HTMLë¡œ ë Œë”ë§
    function renderSchedule() {
      scheduleListEl.innerHTML = SCHEDULE.map(item => `
        <li class="schedule-item" data-time="${item.time}">
          <span>${item.label}</span>
          <span>${item.time}</span>
        </li>
      `).join('');
    }

    function checkAndPlayBell(timeString) {
      // ë¶„:ì´ˆë§Œ ì¶”ì¶œ (ì˜ˆ: '09:25')
      const checkTime = timeString.substring(0, 5); 
      // ì´ˆê°€ '00'ì¼ ë•Œë§Œ ì¢…ì†Œë¦¬ ì²´í¬
      const isBellTime = timeString.substring(6, 8) === '00'; 
      
      if (lastPlayedTime === checkTime && isBellTime) {
        return; 
      }
      
      const bellEvent = SCHEDULE.find(item => item.time === checkTime);
      
      // í˜„ì¬ ì‹œê°„ì„ ê¸°ì¤€ìœ¼ë¡œ ë‹¤ìŒ ì´ë²¤íŠ¸ í•˜ì´ë¼ì´íŠ¸
      const now = new Date();
      const nowTimeStr = `${String(now.getHours()).padStart(2, '0')}:${String(now.getMinutes()).padStart(2, '0')}`;
      
      let nextEvent = null;
      document.querySelectorAll('.schedule-item').forEach(li => {
        li.classList.remove('next-up');
        const itemTime = li.dataset.time;
        if (itemTime > nowTimeStr && !nextEvent) {
            nextEvent = li;
        }
      });
      
      // ìƒíƒœ í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
      if (nextEvent) {
          nextEvent.classList.add('next-up');
          const nextTime = nextEvent.querySelector('span:last-child').textContent;
          const nextLabel = nextEvent.querySelector('span:first-child').textContent;
          statusTextEl.textContent = `ë‹¤ìŒ ë°©ì†¡: ${nextTime} ${nextLabel} (ëŒ€ê¸° ì¤‘...)`;
      } else {
          statusTextEl.textContent = 'ì˜¤ëŠ˜ì˜ ëª¨ë“  ì‹œì¢… ë°©ì†¡ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.';
      }
      
      // ì¢…ì†Œë¦¬ ì¬ìƒ ë¡œì§
      if (bellEvent && isBellTime) {
        if (bellEvent.type === 'start') {
          startBell.currentTime = 0;
          startBell.play().catch(e => console.error("Start bell play failed (Muted/Policy):", e));
          statusTextEl.textContent = `â–¶ï¸ ${bellEvent.label} (${checkTime}) - ì‹œì‘ ì¢…ì†Œë¦¬ ì¬ìƒ ì¤‘`;
        } else if (bellEvent.type === 'end') {
          endBell.currentTime = 0;
          endBell.play().catch(e => console.error("End bell play failed (Muted/Policy):", e));
          statusTextEl.textContent = `â–¶ï¸ ${bellEvent.label} (${checkTime}) - ì¢…ë£Œ ì¢…ì†Œë¦¬ ì¬ìƒ ì¤‘`;
        }
        lastPlayedTime = checkTime; 
        
        // 5ì´ˆ í›„ ë‹¤ìŒ ì´ë²¤íŠ¸ ìƒíƒœë¡œ ë³µê·€
        setTimeout(() => {
            lastPlayedTime = null; 
            updateClockAndBell();
        }, 5000); 
      }
    }
    
    function updateClockAndBell() {
      const now = new Date();
      const hours = String(now.getHours()).padStart(2, '0');
      const minutes = String(now.getMinutes()).padStart(2, '0');
      const seconds = String(now.getSeconds()).padStart(2, '0');
      
      const timeString = `${hours}:${minutes}:${seconds}`;
      currentTimeEl.textContent = timeString;
      
      checkAndPlayBell(timeString);
    }
    
    function startBroadcast() {
        // 1. ìƒíƒœë¥¼ í™œì„± ëª¨ë“œë¡œ ë³€ê²½í•˜ì—¬ ì‹œê³„ì™€ ì¼ì •ì„ í‘œì‹œ
        bodyEl.classList.remove('initial-state');
        bodyEl.classList.add('active-state');
        
        // 2. ì˜¤ë””ì˜¤ë¥¼ ì¬ìƒí•˜ì—¬ ë¸Œë¼ìš°ì €ì˜ ì¬ìƒ ê¶Œí•œì„ íšë“
        // (Chrome ì •ì±… ìƒ play()ë¥¼ í˜¸ì¶œí•´ì•¼ ê¶Œí•œì´ ì™„ì „íˆ ë¶€ì—¬ë¨)
        startBell.volume = 0; // ë¬´ìŒìœ¼ë¡œ ê¶Œí•œ íšë“ ì‹œë„
        startBell.play().then(() => {
            startBell.pause();
            startBell.volume = 1; // ë³¼ë¥¨ ë³µêµ¬
            console.log("Audio playback access granted.");
        }).catch(e => {
            console.warn("Audio playback access failed. Policy may be strict:", e);
        });
        
        // 3. í´ëŸ­ ë° ë°©ì†¡ ë¡œì§ ì‹œì‘
        renderSchedule();
        updateClockAndBell();
        clockInterval = setInterval(updateClockAndBell, 1000);
    }

    // "ë°©ì†¡ ì‹œì‘" ë²„íŠ¼ í´ë¦­ ì‹œ ëª¨ë“  ë¡œì§ ì‹œì‘
    startBtn.addEventListener('click', startBroadcast);

  </script>

</body>
</html>